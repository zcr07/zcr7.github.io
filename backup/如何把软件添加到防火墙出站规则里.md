##  添加出站规则

### 方法一：图形界面添加

打开防火墙设置

按下 Win + R，输入 wf.msc，回车。

打开 高级安全 Windows Defender 防火墙。

新建出站规则

在左侧点击 出站规则。

在右侧点击 新建规则…。

选择规则类型

选择 程序，点 下一步。

指定程序路径

浏览并选择软件的主程序，例如：

C:\Program Files\ExampleApp\example.exe 

点 下一步。

操作选择

如果想 阻止联网 → 选择 阻止连接。

如果想 只允许指定情况联网 → 选择 允许连接。

配置文件

通常全部勾选（域、专用、公用），点 下一步。

命名规则

给规则取个名字（例如 “ExampleApp 出站阻止”），点 完成。 

===============================================

### 方法二：命令行（推荐批量 / 脚本用）

使用 netsh advfirewall： 

```

:: 阻止某个软件出站

netsh advfirewall firewall add rule name="Block ExampleApp Outbound" dir=out action=block program="C:\Program Files\ExampleApp\example.exe" enable=yes

:: 允许某个软件出站

netsh advfirewall firewall add rule name="Allow ExampleApp Outbound" dir=out action=allow program="C:\Program Files\ExampleApp\example.exe" enable=yes


```

=============================================== 


###  管理员身份运行AddFirewallRule.bat 

```

@echo off
:: 必须用管理员权限运行
whoami /groups | find "S-1-16-12288" >nul
if %errorlevel% neq 0 (
    echo 请以管理员身份运行本脚本！
    pause
    exit
)

set /p exePath=请输入要添加到防火墙出站规则的软件主程序路径（例如 C:\Program Files\App\app.exe）：

if not exist "%exePath%" (
    echo 找不到文件：%exePath%
    pause
    exit
)

:: 自动生成规则名称
for %%A in ("%exePath%") do set exeName=%%~nA

echo 正在添加防火墙出站阻止规则：%exeName%
netsh advfirewall firewall add rule name="Block %exeName% Outbound" ^
    dir=out action=block program="%exePath%" enable=yes

echo.
echo 已完成！规则名称：Block %exeName% Outbound
pause


```